appId: com.tuvotodecide
---
# Test: Funcionalidades de cámara y procesamiento de imágenes
- launchApp:
    clearState: false
- tapOn: "Open debugger to view warnings."
- assertNotVisible: "Open debugger to view warnings."

# === FASE 1: SETUP INICIAL ===
- tapOn: "Tengo una cuenta"
- inputText: "1234"
- assertVisible: "Bienvenido"
- tapOn: ", Participar, Sube actas electorales o participa como testigo en el proceso de verificación ciudadana"
- tapOn: "Subir actas electorales"
- tapOn: "Mesa 120"

# === FASE 2: VERIFICAR PERMISOS DE CÁMARA ===
- tapOn: "Tomar Foto"

# Verificar solicitud de permisos
- extendedWaitUntil:
    visible: "Permitir acceso a la cámara"
    timeout: 8000
    optional: true
- tapOn:
    text: "Permitir"
    optional: true

# === FASE 3: INTERFAZ DE CÁMARA ===
- extendedWaitUntil:
    visible: "Cámara"
    timeout: 10000
    optional: true

# Verificar elementos de la interfaz de cámara
- assertVisible:
    text: "Tomar Foto"
    optional: true
- assertVisible:
    text: "Asegúrate de que el acta esté bien iluminada"
    optional: true
- assertVisible:
    text: "Enfocar el acta completa"
    optional: true

# Verificar botones de cámara
- assertVisible:
    id: "captureButton"
    optional: true
- assertVisible:
    id: "flashButton"
    optional: true
- assertVisible:
    id: "flipCameraButton"
    optional: true

# === FASE 4: PROBAR FLASH ===
- tapOn:
    id: "flashButton"
    optional: true
- assertVisible:
    text: "Flash activado"
    optional: true

# Desactivar flash
- tapOn:
    id: "flashButton"
    optional: true
- assertVisible:
    text: "Flash desactivado"
    optional: true

# === FASE 5: CAMBIAR CÁMARA (SI DISPONIBLE) ===
- tapOn:
    id: "flipCameraButton"
    optional: true
- extendedWaitUntil:
    visible: "Cámara frontal"
    timeout: 5000
    optional: true

# Volver a cámara trasera
- tapOn:
    id: "flipCameraButton"
    optional: true

# === FASE 6: TOMAR PRIMERA FOTO ===
- tapOn: "Tomar Foto"
- extendedWaitUntil:
    visible: "Foto capturada"
    timeout: 10000
    optional: true

# === FASE 7: OPCIONES POST-CAPTURA ===
- assertVisible:
    text: "Revisar foto"
    optional: true
- assertVisible:
    text: "Retomar foto"
    optional: true
- assertVisible:
    text: "Continuar"
    optional: true

# === FASE 8: REVISAR CALIDAD DE IMAGEN ===
- tapOn: "Revisar foto"
- assertVisible:
    text: "Verificar calidad"
    optional: true
- assertVisible:
    text: "¿Se ve clara la imagen?"
    optional: true

# Zoom para verificar detalles
- tapOn:
    text: "Hacer zoom"
    optional: true

# === FASE 9: RETOMAR FOTO SI ES NECESARIO ===
- tapOn: "Retomar foto"
- extendedWaitUntil:
    visible: "Cámara"
    timeout: 8000
    optional: true

# Tomar nueva foto
- tapOn: "Tomar Foto"
- tapOn: "Continuar"

# === FASE 10: ANÁLISIS DE IMAGEN CON IA ===
- tapOn:
    text: ", Analizar"
    optional: false
    repeat: 1
    delay: 10000

# Verificar proceso de análisis
- assertVisible:
    text: "Analizando imagen"
    optional: true
- assertVisible:
    text: "Detectando texto"
    optional: true
- assertVisible:
    text: "Procesando datos"
    optional: true

# === FASE 11: RESULTADOS DEL ANÁLISIS ===
- extendedWaitUntil:
    visible: "Acta"
    timeout: 30000

# Verificar datos detectados
- assertVisible:
    text: "Mesa detectada"
    optional: true
- assertVisible:
    text: "Datos extraídos"
    optional: true

# === FASE 12: CALIDAD DE RECONOCIMIENTO ===
- swipe:
    start: "50%, 80%"
    end: "50%, 10%"
    duration: 300

# Verificar confianza del análisis
- assertVisible:
    text: "Confianza: Alta"
    optional: true
- assertVisible:
    text: "Confianza: Media"
    optional: true
- assertVisible:
    text: "Confianza: Baja"
    optional: true

# === FASE 13: CORRECCIÓN MANUAL SI ES NECESARIO ===
- tapOn:
    id: "editButton"
    optional: true

# Verificar campos editables
- scrollUntilVisible:
    element:
      id: partyInputPresidente0
    direction: up
    optional: true

# === FASE 14: GUARDAR Y PROCESAR ===
- tapOn:
    id: "saveButton"
    optional: true

# === FASE 15: SUBIDA DE IMAGEN A IPFS ===
- tapOn:
    id: "nextButton"
    optional: true

# Verificar proceso de subida
- assertVisible:
    text: "Subiendo imagen a IPFS"
    optional: true
- assertVisible:
    text: "Generando hash"
    optional: true

# === FASE 16: MÚLTIPLES FOTOS (SI SOPORTADO) ===
- tapOn:
    text: "Agregar otra foto"
    optional: true

- extendedWaitUntil:
    visible: "Cámara"
    timeout: 8000
    optional: true

- tapOn: "Tomar Foto"
- tapOn: "Continuar"

# === FASE 17: COMPARACIÓN DE IMÁGENES ===
- assertVisible:
    text: "IA seleccionará la mejor imagen"
    optional: true
- assertVisible:
    text: "Comparando calidad"
    optional: true

# === FASE 18: PUBLICACIÓN FINAL ===
- tapOn: "Publico y Certifico"
- extendedWaitUntil:
    visible: "Certificado NFT"
    timeout: 35000
    optional: true

# === FASE 19: VERIFICAR IMAGEN EN CERTIFICADO ===
- assertVisible:
    text: "Ver imagen original"
    optional: true
- tapOn:
    text: "Ver imagen original"
    optional: true

# Verificar que se puede ver la imagen subida
- assertVisible:
    text: "Imagen en IPFS"
    optional: true

# === FASE 20: CASOS DE ERROR DE CÁMARA ===
- tapOn: "Regresar"
- tapOn: "Tomar otra foto"

# Simular error de cámara
- extendedWaitUntil:
    visible: "Error de cámara"
    timeout: 10000
    optional: true
- extendedWaitUntil:
    visible: "No se pudo acceder a la cámara"
    timeout: 10000
    optional: true

# Verificar alternativas
- assertVisible:
    text: "Seleccionar de galería"
    optional: true
- tapOn:
    text: "Seleccionar de galería"
    optional: true
