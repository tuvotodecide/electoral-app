appId: com.tuvotodecide
---
# Test: Seguridad y validaciones de entrada en autenticación
- launchApp:
    clearState: false
- tapOn: "Open debugger to view warnings."
- assertNotVisible: "Open debugger to view warnings."

# === FASE 1: VALIDACIONES DE ENTRADA EN LOGIN ===
- tapOn: "Tengo una cuenta"
- assertVisible: "Acceso a la billetera"

# Probar con entrada vacía
- inputText: ""
- extendedWaitUntil:
    visible: "PIN requerido"
    timeout: 3000
    optional: true

# Probar con caracteres especiales
- inputText: "!@#$"
- extendedWaitUntil:
    visible: "Solo números permitidos"
    timeout: 3000
    optional: true

# Probar con letras
- inputText: "abcd"
- extendedWaitUntil:
    visible: "Solo números permitidos"
    timeout: 3000
    optional: true

# Probar con PIN muy largo
- inputText: "123456789"
- extendedWaitUntil:
    visible: "PIN debe tener 4 dígitos"
    timeout: 3000
    optional: true

# === FASE 2: LOGIN EXITOSO ===
- inputText: "1234"
- extendedWaitUntil:
    visible: "Bienvenido"
    timeout: 10000

# === FASE 3: VALIDACIONES EN CAMBIO DE PIN ===
- tapOn: "Perfil"
- scrollUntilVisible:
    element:
      text: "Ajustes de seguridad"
    direction: down
- tapOn: "Ajustes de seguridad"
- tapOn: "Cambiar PIN"

# Validar PIN actual
- assertVisible: "Introduce tu pin actual"

# PIN actual vacío
- inputText: ""
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN requerido"
    timeout: 3000
    optional: true

# PIN actual con caracteres inválidos
- inputText: "12a4"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "Solo números permitidos"
    timeout: 3000
    optional: true

# PIN actual correcto
- inputText: "1234"
- tapOn: "Continuar"
- assertVisible: "Crea tu PIN de acceso"

# === FASE 4: VALIDACIONES DE NUEVO PIN ===
# PIN demasiado simple
- inputText: "0000"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN muy simple"
    timeout: 3000
    optional: true

# PIN secuencial
- inputText: "1234"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN secuencial no permitido"
    timeout: 3000
    optional: true

# PIN repetitivo
- inputText: "1111"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN repetitivo no permitido"
    timeout: 3000
    optional: true

# PIN válido
- inputText: "5678"
- tapOn: "Continuar"
- assertVisible: "Confirma tu PIN de acceso"

# === FASE 5: VALIDACIONES DE CONFIRMACIÓN ===
# Confirmación vacía
- inputText: ""
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "Confirmación requerida"
    timeout: 3000
    optional: true

# Confirmación diferente
- inputText: "5679"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "Los PIN no coinciden"
    timeout: 5000

# Confirmación correcta
- inputText: "5678"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "PIN actualizado exitosamente"
    timeout: 10000
- tapOn: "Entendido"

# === FASE 6: VALIDACIONES EN BÚSQUEDA DE GUARDIANES ===
- tapOn: "Guardianes"
- tapOn: "Agregar guardián"

# CI vacío
- inputText: ""
- tapOn: "Buscar"
- extendedWaitUntil:
    visible: "CI requerido"
    timeout: 3000
    optional: true

# CI con letras
- inputText: "1234abcd"
- tapOn: "Buscar"
- extendedWaitUntil:
    visible: "CI debe contener solo números"
    timeout: 3000
    optional: true

# CI muy corto
- inputText: "123"
- tapOn: "Buscar"
- extendedWaitUntil:
    visible: "CI debe tener al menos 7 dígitos"
    timeout: 3000
    optional: true

# CI muy largo
- inputText: "123456789012345"
- tapOn: "Buscar"
- extendedWaitUntil:
    visible: "CI demasiado largo"
    timeout: 3000
    optional: true

# CI válido pero no existe
- inputText: "12345678"
- tapOn: "Buscar"
- extendedWaitUntil:
    visible: "Persona no encontrada"
    timeout: 10000
    optional: true

- tapOn: "Regresar"

# === FASE 7: VALIDACIONES DE SEGURIDAD EN SESIÓN ===
# Verificar timeout de sesión
- extendedWaitUntil:
    visible: "Sesión expirada"
    timeout: 300000  # 5 minutos
    optional: true

# Si la sesión expira, debería regresar al login
- assertVisible:
    text: "Tengo una cuenta"
    optional: true

# === FASE 8: RESTAURAR ESTADO Y VERIFICAR SEGURIDAD ===
- launchApp:
    clearState: false

# Verificar que mantiene PIN actualizado
- tapOn: "Tengo una cuenta"
- inputText: "5678"
- extendedWaitUntil:
    visible: "Bienvenido"
    timeout: 10000

# === FASE 9: RESTAURAR PIN ORIGINAL PARA OTROS TESTS ===
- tapOn: "Perfil"
- scrollUntilVisible:
    element:
      text: "Ajustes de seguridad"
    direction: down
- tapOn: "Ajustes de seguridad"
- tapOn: "Cambiar PIN"
- inputText: "5678"
- tapOn: "Continuar"
- inputText: "1234"
- tapOn: "Continuar"
- inputText: "1234"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "PIN actualizado exitosamente"
    timeout: 10000
- tapOn: "Entendido"
