appId: com.tuvotodecide
---
# Test: Flujo completo de cambio de PIN con validaciones
- launchApp:
    clearState: false
- tapOn: "Open debugger to view warnings."
- assertNotVisible: "Open debugger to view warnings."

# === FASE 1: LOGIN INICIAL ===
- tapOn: "Tengo una cuenta"
- assertVisible: "Acceso a la billetera"
- inputText: "1234"
- assertVisible: "Bienvenido"

# === FASE 2: NAVEGAR A CAMBIO DE PIN ===
- tapOn: "Perfil"
- scrollUntilVisible:
    element:
      text: "Ajustes de seguridad"
    direction: down
- tapOn: "Ajustes de seguridad"
- assertVisible: "Cambiar PIN"
- tapOn: "Cambiar PIN"

# === FASE 3: VALIDACIÓN PIN ACTUAL INCORRECTO ===
- assertVisible: "Introduce tu pin actual para confirmar"
- inputText: "0000"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN incorrecto"
    timeout: 5000
    optional: true

# === FASE 4: PIN ACTUAL CORRECTO ===
- inputText: "1234"
- tapOn: "Continuar"
- assertVisible: "Crea tu PIN de acceso"

# === FASE 5: NUEVO PIN - CASOS LIMITE ===
# Intentar PIN muy simple
- inputText: "1111"
- tapOn: "Continuar"
- extendedWaitUntil:
    visible: "PIN muy simple"
    timeout: 3000
    optional: true

# PIN válido para el nuevo
- inputText: "5678"
- tapOn: "Continuar"
- assertVisible: "Confirma tu PIN de acceso"

# === FASE 6: CONFIRMACIÓN INCORRECTA ===
- inputText: "5679"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "Los PIN no coinciden"
    timeout: 5000
    optional: true

# === FASE 7: CONFIRMACIÓN CORRECTA ===
- inputText: "5678"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "PIN actualizado exitosamente"
    timeout: 10000
- tapOn: "Entendido"

# === FASE 8: LOGOUT Y VERIFICAR NUEVO PIN ===
- tapOn: "Más"
- scrollUntilVisible:
    element:
      text: "Cerrar sesión"
    direction: down
- tapOn: "Cerrar sesión"
- tapOn: "Cerrar sesión"

# Verificar que el PIN anterior ya no funciona
- tapOn: "Tengo una cuenta"
- inputText: "1234"
- extendedWaitUntil:
    visible: "PIN incorrecto"
    timeout: 5000

# Verificar que el nuevo PIN funciona
- inputText: "5678"
- extendedWaitUntil:
    visible: "Bienvenido"
    timeout: 10000

# === FASE 9: RESTAURAR PIN ORIGINAL ===
- tapOn: "Perfil"
- scrollUntilVisible:
    element:
      text: "Ajustes de seguridad"
    direction: down
- tapOn: "Ajustes de seguridad"
- tapOn: "Cambiar PIN"
- inputText: "5678"
- tapOn: "Continuar"
- inputText: "1234"
- tapOn: "Continuar"
- inputText: "1234"
- tapOn: "Confirmar PIN"
- extendedWaitUntil:
    visible: "PIN actualizado exitosamente"
    timeout: 10000
- tapOn: "Entendido"
